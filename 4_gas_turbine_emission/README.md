![image](https://user-images.githubusercontent.com/103372805/218334974-5bf7c899-4689-4912-9d85-14c96eaa0484.png)

# Gas-Turbine CO and NOx Emission

![tmp2943g1tv](https://user-images.githubusercontent.com/103372805/202800560-5b020e5d-5e22-4ea9-a05e-e40ca3fc2aa0.svg)

## 1. Описание
В данной работе был рассмотрен датасет, в котором представлены показания различных датчиков газотурбинных двигателей. Данные двигатели используются в составе 
газотурбинных установок (ГТУ), применяемых для генерации энергии на различных электростанциях. Данные взяты с сайта 
[Kaggle](https://www.kaggle.com/datasets/muniryadi/gasturbine-co-and-nox-emission-data)

## 2. Что нужно сделать
В данной работе необходимо построить регрессионную модель, способную, как можно точней, предсказывать выбросы угарного газа CO и оксидов азота NOx для различных
ГТУ.

## 3. Краткая информация о данных

1) **AT**: *температура воздуха, &deg;C;*
2) **PT**: *атмосферное давление, мбар;*
3) **AH**: *влажность воздуха, %;* 
4) **AFDP**: *перепад давления на воздушном фильтре, мбар;*
5) **GTEP**<sup>1</sup>: *давление газа на выходе из турбины, мбар;* 
6) **TIT**: *температура газа на входе в турбину, &deg;C;*
7) **TAT**: *температура газа на выходе из турбины, &deg;C;* 
8) **CDP**<sup>2</sup>: *давление после компрессора, мбар;*
9) **TEY**: *мощность турбины, МВт;*
10) **CO**: *выбросы угарного газа, мг/м<sup>3</sup>;*
11) **NOX**: *выбросы оксидов азота, мг/м<sup>3</sup>.*

**Примечания:**  
<sup>1</sup> Здесь указано не абсолютное, а избыточное давление газа относительно атмосферного  
<sup>2</sup> Здесь указано не давление, а степень сжатия в компрессоре как отношение давления на выходе к давлению на входе

## 4. Содержание работы
**_Исследование данных_**

В датасете оказалось более 30 тыс. объектов. Проспусков и дубликатов среди значений не было, но имело место большое число аномалий. Такой большой разброс значений,
особенно среди выбросов угарного газа, мог быть вызван как некорректными значениями, так и работой некоторых ГТУ на различных нестационарных режимах. 
Также сильное отличие в рабочих характеристиках турбин могло быть вызвано различными видами топлива (природный газ, керосин). Так, наиболее экологичным видом топлива 
будет очищенный от различных примесей природный газ (как правило, ГТУ на природном газе наиболее распространённые). Поэтому в данной работе было важно применить
правильную стратегию по учёту аномалий, так как они оказывали сильное влияние на итоговый результат.

**_Очистка данных_**

Для работы с аномалиями было рассмотрено два подхода: удаление выбросов с помощью межквартильного интервала и обнаружение аномалий с помощью кластеризации 
_DBSCAN_. При использовании первого метода мы не получили высокой точности. Этому было простое объяснение: мы удалили выбросы среди признаков, но при этом остались 
выбросы среди целевых значений (особенно среди значений угарного газа). Идея второго подхода заключалась в том, чтобы пометить те образцы как аномальные, у 
которых среди целевых значений были выбросы. Для этого использовался алгоритм _DBSCAN_. Хотя _DBSCAN_ изначально является эффективным алгоритмом кластеризации, 
в данном случае он использовался именно для поиска аномалий. Помимо _DBSCAN_ рассматривались и другие алгоритмы: Isolation Forest, Local Outlier Factor, но они 
показали меньшую эффективность (эти исследования в работу не вошли). Затем проводилось обучение регрессионной модели только на центральных образцах. Для предсказания аномалий
среди тестовой выборки применялся _KNeighborsClassifier_, обученный на тренировочной выборке (У DBSCAN, к сожалению, метод predict отсутствует). И после предсказания
аномалий на тестовых значениях, предсказательная регрессионная модель работала только с нормальными данными. Блягодаря такому подходу, удалось добиться повышения
точности почти на 40 %.

**_Моделирование_**

Сравнение моделей проводилось с использованием библиотеки scikit-learn (см. Замечания). Использовались следующие модели: _LinearRegression_, _SVR_, 
_DecisionTreeRegressor_, _RandomForestRegressor_, а также _XGBRegressor_. 

## 5. Результаты работы

Лучший результат показал случайный лес. Немного хуже показал себя XGBRegressor. Поиск оптимальных гиперпараметров не проводился.

## 6. Замечания

1. В ноутбуке для загрузки данных напрямую с Kaggle используется API. Как установить и пользоваться показано [тут](https://github.com/Kaggle/kaggle-api). 
Датасет можно посмотреть по этой [ссылке](https://www.kaggle.com/datasets/muniryadi/gasturbine-co-and-nox-emission-data). 

2. В работе использовался [Intel(R) Extension for Scikit-learn](https://github.com/intel/scikit-learn-intelex) для ускорения вычислений _LinearRegression_, 
_SVR_, _RandomForestRegerssor_ и _DBSCAN_. Использование данной библиотеки необязательно.
